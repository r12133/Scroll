"use strict";function logISay(){console.clear(),console.warn("网站设计灵感和图片来源均来自 http://graphicnovel-hybrid4.peugeot.com/start.html")}function animate(e,t){t.forEach(function(t){t.key="data-"+t.key,e.setAttribute(t.key,t.value)})}function startScroll(e){e.innerText="AUTOPLAY ON",clearInterval(control.t),control.t=setInterval(function(){var t=document.documentElement.scrollTop;t>=13*win_h+200&&t<=13*win_h+200+192+30?document.documentElement.scrollTop=t+1:document.documentElement.scrollTop+=2,t==document.documentElement.scrollTop&&stopScroll(e)},control.speed)}function stopScroll(e){e.innerText="AUTOPLAY OFF",clearInterval(control.t)}function openBgMusic(e){e.innerText="SOUND ON",document.querySelector(".bg_audio").muted=!1}function stopBgMusic(e){e.innerText="SOUND OFF",document.querySelector(".bg_audio").muted=!0}function define_scroll_speed(e){e=e||8,document.onmousewheel=function(t){t.preventDefault(),t.returnValue=!1,t.deltaY>0?document.documentElement.scrollTop+=e:document.documentElement.scrollTop-=e}}function playAudio(e,t,n){var o=document.createElement("audio");t&&(o=document.querySelector(".bg_audio"),o.loop=n||!1,o.volume=.5),o.src=e||"http://graphicnovel-hybrid4.peugeot.com/music/BoucleMusique_ZEV.ogg",o.play(),o.onended=function(){var t=control.audioArr.indexOf(e);setTimeout(function(){return control.audioArr.splice(t,1)},5e3)}}function init(){logISay();skrollr.init()}function change_first_settings(){var e=document.querySelector(".change_first .page"),t=document.querySelector(".page_six"),n=document.querySelector(".page_seven"),o=document.querySelector(".left_left"),l=document.querySelector(".page_eight"),i=document.querySelector(".page_nine"),a=document.querySelector(".page_battle"),r=document.querySelector(".left_left_end"),u=document.querySelector(".page_ten"),c=document.querySelector(".page_eleven"),_=document.querySelector(".page_twelve"),y=document.querySelector(".page_thirteen"),p=document.querySelector(".page_fourteen"),h=document.querySelector(".page_fiveteen"),d=document.querySelector(".page_sixteen"),g=document.querySelector(".page_seventeen"),m=document.querySelector(".page_eightteen"),s=document.querySelector(".page_nineteen"),w=document.querySelector(".page_end");e.style.paddingBottom="100px",e.style.boxSizing="content-box",t.style.top=-1*win_h-100+"px",n.style.marginTop="200px",n.style.top=-2*win_h-300+"px",o.style.top=-3*win_h-300+"px",l.style.top=-4*win_h-300+"px",i.style.top=-5*win_h-300+"px",a.style.top=-6*win_h-330+"px",a.style.marginBottom="192px",r.style.top=-7*win_h-330-192+"px",u.style.top=-8*win_h-330-192+"px",c.style.top=-9*win_h-330-192+"px",_.style.top=-11*win_h-330-192+"px",y.style.top=-12*win_h-330-192+"px",p.style.top=-14*win_h-330-192+"px",h.style.top=-15*win_h-330-192+"px",d.style.top=-15*win_h-330-192+"px",g.style.top=-16*win_h-330-192+"px",m.style.top=-17*win_h-330-192+"px",s.style.top=-17*win_h-330-192+"px",w.style.top=-18*win_h-330-192+"px"}function completed(){setTimeout(function(){document.documentElement.scrollTop=0},0),define_scroll_speed(control.user_scroll_speed);var e=document.querySelector(".status");control.autoplay&&startScroll(e),e.onclick=function(){control.autoplay=!control.autoplay,control.autoplay&&startScroll(this),!control.autoplay&&stopScroll(this)},document.querySelector(".sound").onclick=function(){control.bgMusicOn=!control.bgMusicOn,control.bgMusicOn&&openBgMusic(this),!control.bgMusicOn&&stopBgMusic(this)};var t=document.querySelectorAll(".page");Array.prototype.forEach.call(t,function(e,t,n){e.style.height=win_h+"px"}),document.addEventListener("scroll",winScroll,!1);var n=document.querySelector(".page_one");n.style.marginBottom="-100px",animate(n,[{key:win_h,value:"top:0px;"},{key:1.5*win_h-50,value:"top:-100px;"}]),animate(document.querySelector(".page_two .girl"),[{key:1.5*win_h+100,value:"right: 150px;"},{key:2*win_h,value:"right: 100px;"}]),animate(document.querySelector(".page_three .verre"),[{key:3*win_h-100,value:"left: 100px;top:-150px;"},{key:5*win_h-100,value:"left: 400px;top: -200px;"}]),animate(document.querySelector(".page_four .girl"),[{key:4.5*win_h-100,value:"left: 50%"},{key:5.5*win_h-100,value:"left: 52%"}]);var o=document.querySelector(".page_five .dog_left"),l=document.querySelector(".page_five .dog_right"),i=[{key:5*win_h-100,value:"left: -400px"},{key:7*win_h-100,value:"left: -100px"}],a=[{key:5*win_h-100,value:"right: 0px"},{key:7*win_h-100,value:"right: -300px"}];animate(o,i),animate(l,a),change_first_settings();var r=document.querySelector(".page_six"),u=document.querySelector(".page_six .girl"),c=[{key:7*win_h,value:"left: 100%"},{key:9*win_h,value:"left: -100%"}],_=[{key:7.5*win_h,value:"right: -300px"},{key:9*win_h,value:"right: 0px"}];animate(r,c),animate(u,_),animate(document.querySelector(".page_seven"),[{key:9*win_h+200,value:"left: 0%;"},{key:10*win_h+200,value:"left: -100%;"}]),animate(document.querySelector(".page_eight"),[{key:10*win_h+200,value:"left: 100%;transform: rotateZ(-5deg);"},{key:12*win_h+200,value:"left: -100%;transform: rotateZ(5deg);"}]);var y=document.querySelector(".page_nine"),p=document.querySelector(".page_nine .girl"),h=[{key:11*win_h+200,value:"left: 100%"},{key:13*win_h+200,value:"left: -100%"}],d=[{key:11*win_h+200,value:"left: -800px"},{key:13*win_h+200,value:"left: 0px"}];animate(y,h),animate(p,d),animate(document.querySelector(".page_battle"),[{key:13*win_h+200+192+30,value:"left: 0%"},{key:14*win_h+200+192+30,value:"left: -100%"}]);var g=document.querySelector(".page_ten"),m=document.querySelector(".page_ten .girl"),s=[{key:14*win_h+200+192+30,value:"left: 100%"},{key:16*win_h+200+192+30,value:"left: -100%"}],w=[{key:14*win_h+200+192+30,value:"top: 13%;left:26%;"},{key:16*win_h+200+192+30,value:"top:18%;left:36%"}];animate(g,s),animate(m,w);var f=document.querySelector(".page_eleven"),v=document.querySelector(".page_eleven .girl"),k=[{key:15*win_h+200+192+30,value:"left: 100%"},{key:17*win_h+200+192+30,value:"left: -100%"}],S=[{key:15*win_h+200+192+30,value:"top: 12%;left:36%;transform: rotateZ(-7deg);"},{key:17*win_h+200+192+30,value:"top:8%;left:24%;transform: rotateZ(7deg);"}];animate(f,k),animate(v,S);var x=document.querySelector(".page_twelve"),q=document.querySelector(".page_twelve .car"),A=[{key:17*win_h+200+192+30,value:"left: 100%"},{key:19*win_h+200+192+30,value:"left: -100%"}],b=[{key:17*win_h+200+192+30,value:"left: 27%"},{key:19*win_h+200+192+30,value:"left: 33%"}];animate(x,A),animate(q,b);var P=document.querySelector(".page_thirteen"),T=document.querySelector(".page_thirteen .girl"),O=[{key:18*win_h+200+192+30,value:"left: 100%"},{key:20*win_h+200+192+30,value:"left: -100%"}],E=[{key:18*win_h+200+192+30,value:"left: 45%"},{key:20*win_h+200+192+30,value:"left: 55%"}];animate(P,O),animate(T,E);var M=document.querySelector(".page_fourteen"),B=document.querySelector(".page_fourteen .girl"),I=[{key:20*win_h+200+192+30,value:"top: "+(-14*win_h-330-192)+"px;"},{key:22*win_h+200+192+30,value:"top: "+(-12*win_h-330-192)+"px;"}],Y=[{key:20*win_h+200+192+30,value:"bottom: 0px"},{key:22*win_h+200+192+30,value:"bottom: -100px"}];animate(M,I),animate(B,Y),animate(document.querySelector(".page_fiveteen"),[{key:21*win_h+200+192+30,value:"top: "+(-15*win_h-330-192)+"px;"},{key:23*win_h+200+192+30,value:"top: "+(-13*win_h-330-192)+"px;"}]),animate(document.querySelector(".page_sixteen"),[{key:23*win_h+200+192+30,value:"left: 100%"},{key:25*win_h+200+192+30,value:"left: -100%"}]),animate(document.querySelector(".page_seventeen"),[{key:24*win_h+200+192+30,value:"left: 100%"},{key:26*win_h+200+192+30,value:"left: -100%"}]);var Z=document.querySelector(".page_eightteen"),F=document.querySelector(".page_eightteen .girl"),N=[{key:25*win_h+200+192+30,value:"left: 100%"},{key:27*win_h+200+192+30,value:"left: -100%"}],U=[{key:25*win_h+200+192+30,value:"left: -500px"},{key:27*win_h+200+192+30,value:"left: 0px"}];animate(Z,N),animate(F,U),animate(document.querySelector(".page_nineteen"),[{key:27*win_h+200+192+30,value:"top: "+(-17*win_h-330-192)+"px;"},{key:29*win_h+200+192+30,value:"top: "+(-19*win_h-330-192)+"px;"}]),animate(document.querySelector(".page_end"),[{key:28*win_h+200+192+30,value:"top: "+(-18*win_h-330-192)+"px;"},{key:29*win_h+200+192+30,value:"top: "+(-19*win_h-330-192)+"px;"}]),init()}function winScroll(){var e=document.documentElement.scrollTop;globalAudioSettings(e);var t=document.querySelector(".change_first"),n=document.querySelector(".page_seven"),o=document.querySelector(".page_eight"),l=document.querySelector(".left_left"),i=document.querySelector(".page_battle"),a=document.querySelector(".left_left_end"),r=document.querySelector(".page_eightteen");t.style.position=e>=7*win_h-100?"fixed":"relative",e>=8*win_h&&e<9*win_h+300?(n.style.left="0%",l.style.left="0px"):e<8*win_h&&(n.style.left="100%",l.style.left="100%"),e>=12*win_h+200&&e<=13*win_h+200+192+30?("rotateY(0deg)"!=o.style.transform&&(o.style.transform="rotateY(0deg)"),i.style.left="0%"):i.style.left="100%",e>=13*win_h+200&&e<=13*win_h+200+192+30?function(){define_scroll_speed();var t=i.children[0],n=e-(13*win_h+200+30),o=n/8;Math.floor(o)!=o&&(o=Math.floor(o)+1),o<=0&&(o=1),t.src="img/"+o+".jpg"}():define_scroll_speed(control.user_scroll_speed),e>=13*win_h+200+192+30?(a.style.left="0%",i.style.left="100%"):a.style.left="100%",e>=25.3*win_h+200+192+30&&e<27*win_h+200+192+30&&function(){var t=e-(25.3*win_h+200+192+30),n=parseInt(t/48);0==n&&(r.style.backgroundImage="url('img/bg(16).jpg')",r.style.opacity=.4),n>=2&&(r.style.opacity=2*n/10,r.style.backgroundImage="url('img/bg(16_2).jpg')")}()}function checkAndPlay(e,t,n){control.audioArr.indexOf(e)<0&&(control.audioArr.push(e),playAudio(e,t,n))}function globalAudioSettings(e){e>=.3*win_h&&e<=1.8*win_h&&checkAndPlay("audio/bg_start.ogg",!0,!0),e>=1.3*win_h&&e<=1.8*win_h&&checkAndPlay("audio/kick_door.ogg"),e>=3.2*win_h&&checkAndPlay("audio/bg_high.ogg",!0,!0),e>=3.5*win_h&&e<=4*win_h&&checkAndPlay("audio/verre.ogg"),e>=5.5*win_h&&e<=6*win_h&&checkAndPlay("audio/dogs.ogg"),e>=7.5*win_h&&e<=8*win_h&&checkAndPlay("audio/dogs_chase.ogg"),e>=10.5*win_h&&e<=11*win_h&&checkAndPlay("audio/car_drive_far.ogg"),e>=11.8*win_h&&e<=13*win_h&&checkAndPlay("audio/car_drive_close.ogg"),e>=13*win_h+100&&e<=13*win_h+422&&checkAndPlay("audio/battle.ogg"),e>=14.5*win_h+422&&e<=15.5*win_h+422&&checkAndPlay("audio/slide_down.ogg"),e>=17.5*win_h+422&&e<=18.5*win_h+422&&checkAndPlay("audio/bg_flying.ogg",!0),e>=21.7*win_h+422&&e<=22.5*win_h+422&&checkAndPlay("audio/enter.ogg"),e>=25.5*win_h+422&&e<=26*win_h+422&&checkAndPlay("audio/light_on.ogg"),e>=26*win_h+422&&checkAndPlay("audio/bg_end.ogg",!0,!0)}var win_h=window.innerHeight,control={t:0,autoplay:!0,speed:8,audio:!1,user_scroll_speed:48,audioArr:[],bgMusicOn:!0};window.onresize=function(){window.location.reload()},document.onreadystatechange=function(){if("complete"==document.readyState){var e=document.querySelector(".mask");document.body.removeChild(e),completed()}};